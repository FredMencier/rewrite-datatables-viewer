@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  body {
    @apply bg-slate-950 text-slate-100 antialiased;
    min-height: 100dvh;
  }
}

@layer components {
  .material-symbols-outlined {
    font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
  }

  #app {
    @apply min-h-screen;
  }

  .header {
    @apply sticky top-0 z-20 border-b border-violet-500/30 bg-slate-950/85 backdrop-blur;
  }

  .header-content {
    @apply mx-auto flex max-w-[1680px] items-center justify-between px-4 py-4;
  }

  .app-title {
    @apply flex items-center gap-2 text-lg font-bold tracking-tight;
  }

  .header-controls {
    @apply flex items-center gap-2;
  }

  .btn {
    @apply inline-flex items-center justify-center rounded-lg border border-violet-500/40 px-3 py-2 text-xs font-semibold uppercase tracking-wide transition;
  }

  .btn:hover {
    @apply bg-violet-600/20;
  }

  .btn-primary {
    @apply border-violet-600 bg-violet-600 text-white;
  }

  .btn-secondary {
    @apply bg-slate-900 text-slate-200;
  }

  .btn-sm {
    @apply px-2 py-1 text-[10px];
  }

  .loading-overlay {
    @apply fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm;
  }

  .loading-overlay.hidden {
    display: none;
  }

  .spinner {
    @apply mx-auto mb-3 h-10 w-10 animate-spin rounded-full border-4 border-slate-600 border-t-primary;
  }

  .main-content {
    @apply mx-auto w-full max-w-[1680px] px-4 pb-6 pt-4;
  }

  .nav-tabs {
    @apply mb-4 flex gap-2 overflow-x-auto rounded-xl border border-violet-500/30 bg-slate-900/80 p-2;
  }

  .tab-button {
    @apply inline-flex items-center gap-2 whitespace-nowrap rounded-lg border border-transparent px-3 py-2 text-xs font-semibold text-slate-300 transition;
  }

  .tab-button:hover {
    @apply border-violet-500/40 bg-violet-600/15 text-white;
  }

  .tab-button.active {
    @apply border-violet-600 bg-violet-600/30 text-white;
  }

  .tab-panel {
    @apply hidden;
  }

  .tab-panel.active {
    @apply block;
  }

  .dashboard-grid {
    @apply grid gap-4;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  }

  .full-width {
    grid-column: 1 / -1;
  }

  .chart-container,
  .files-table-container,
  .metric-card {
    @apply overflow-hidden rounded-xl border border-violet-500/30 bg-slate-900 shadow-panel;
  }

  .chart-card {
    @apply flex h-full flex-col;
  }

  .chart-header {
    @apply flex items-center justify-between border-b border-violet-500/30 bg-black/20 px-4 py-3;
  }

  .chart-header h3 {
    @apply text-sm font-semibold text-slate-100;
  }

  .chart-controls {
    @apply flex items-center gap-2;
  }

  .chart-controls select {
    @apply rounded-lg border border-violet-500/40 bg-slate-900 px-3 py-2 text-xs font-medium text-slate-200 transition;
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2394a3b8' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 0.75rem center;
    padding-right: 2rem;
    min-width: 120px;
  }

  .chart-controls select:hover {
    @apply border-violet-400 bg-slate-800;
  }

  .chart-controls select:focus {
    @apply outline-none border-violet-500 ring-2 ring-violet-500/30;
  }

  .chart-controls select option {
    @apply bg-slate-900 text-slate-200;
  }

  .chart-body {
    @apply min-h-[320px] p-4;
  }

  .kpi-cards {
    @apply col-span-full grid gap-3;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  }

  .kpi-card {
    @apply flex items-center gap-3 rounded-xl border border-violet-500/30 bg-slate-900/50 p-4;
  }

  .kpi-icon {
    @apply flex h-12 w-12 items-center justify-center rounded-full bg-violet-600/25 text-xl;
  }

  .kpi-value {
    @apply text-2xl font-bold text-white;
  }

  .kpi-label {
    @apply text-xs font-medium uppercase tracking-wide text-slate-400;
  }

  .chart-empty {
    @apply flex min-h-[280px] items-center justify-center rounded-lg border border-dashed border-violet-500/40 text-sm text-slate-400;
  }

  /* Conteneurs de graphiques ECharts */
  #savings-by-recipe-chart,
  #execution-time-chart,
  #scan-vs-edit-chart,
  #file-changes-chart,
  #recipe-hierarchy-chart {
    width: 100%;
    height: 350px;
    min-height: 300px;
  }

  /* Assure que les graphiques ECharts occupent tout l'espace disponible */
  .chart-body .echarts-tooltip {
    @apply z-50;
  }

  .files-header {
    @apply mb-4 flex items-center justify-between;
  }

  .files-title {
    @apply text-base font-semibold text-white;
  }

  .file-filter {
    @apply rounded-md border border-violet-500/40 bg-slate-900 px-3 py-2 text-sm text-slate-200;
  }

  .files-table,
  .usage-table {
    @apply w-full border-collapse text-xs;
  }

  .files-table th,
  .usage-table th {
    @apply border border-violet-500/40 bg-violet-600/20 px-2 py-2 text-left font-semibold text-slate-100;
  }

  .files-table td,
  .usage-table td {
    @apply border border-violet-500/30 px-2 py-2 text-slate-300;
  }

  .files-table tbody tr:hover,
  .usage-table tbody tr:hover {
    @apply bg-violet-600/10;
  }

  .file-name {
    @apply font-medium text-slate-100;
  }

  .file-directory {
    @apply font-mono text-[11px] text-slate-500;
  }

  .recipe-name {
    @apply font-mono text-xs text-violet-300;
  }

  .time-saved {
    @apply text-emerald-300;
  }

  .cycle-number {
    @apply font-mono text-sky-300;
  }

  .usage-meta {
    @apply mb-2 text-xs text-slate-400;
  }

  .toast-container {
    @apply fixed right-3 top-3 z-50 flex flex-col gap-2;
  }

  .toast {
    @apply min-w-[280px] rounded-lg border border-violet-500/40 bg-slate-900 p-3 text-sm;
  }

  .toast.success {
    @apply border-emerald-400;
  }

  .toast.error {
    @apply border-rose-400;
  }

  .toast.warning {
    @apply border-amber-400;
  }

  .toast-header {
    @apply mb-1 flex items-center justify-between;
  }

  .toast-close {
    @apply rounded px-2 py-0.5 text-slate-300 hover:bg-violet-600/20;
  }

  .error-overlay {
    @apply fixed inset-0 z-[9999] flex items-center justify-center bg-black/70;
  }

  .error-content {
    @apply max-w-xl rounded-xl border border-rose-400/60 bg-slate-900 p-6;
  }

  .error-content pre {
    @apply my-3 overflow-x-auto rounded border border-slate-700 bg-black/40 p-3 text-xs;
  }
}
